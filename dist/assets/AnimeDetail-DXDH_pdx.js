import{c as j,u as v,b as w,j as e,d as k,P as u}from"./main-qQthZKlx.js";import{f as I,r as b,L as y}from"./vendor-YPvam5jz.js";import{u as L}from"./useAniListImage-Dmqd5tXd.js";import{C,a as $}from"./clock-eS7mdhKU.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=j("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=j("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),O=()=>{var h,g,f;const{id:d}=I(),{data:i,loading:x,error:N}=v("anime",{id:d}),o=b.useRef(),{gsap:l,ScrollTrigger:m}=w(),{image:c}=L(((h=i==null?void 0:i.data)==null?void 0:h.title)||"");if(b.useEffect(()=>{if(!x&&i&&o.current){const a=l.context(()=>{const t=o.current;t&&l.fromTo(t,{opacity:0,y:20},{opacity:1,y:0,duration:.6,ease:"power2.out"});const r=t.querySelectorAll(".episode-item");r.length>0&&l.fromTo(r,{opacity:0,y:10},{opacity:1,y:0,stagger:.03,duration:.5,delay:.5})},o);return()=>{a.revert(),m.getAll().forEach(t=>{var r;(r=o.current)!=null&&r.contains(t.trigger)&&t.kill()})}}},[x,i,l,m]),x)return e.jsx("div",{className:"min-h-screen pt-20 flex justify-center text-dhex-accent",children:"Loading..."});if(N)return e.jsx("div",{className:"min-h-screen pt-20 flex justify-center text-red-500",children:"Error loading anime details"});if(!i)return null;const s=i.data,n=s.episodeList||[],p=async a=>{try{console.log("ðŸ“ Pre-logging watch (from AnimeDetail):",{animeId:s.animeId,title:s.title,episode:a}),await fetch("/dhexstream/api.php?endpoint=log_recent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({animeId:s.animeId,title:s.title,poster:s.poster,href:`${s.animeId}/${a}`,currentTime:0,duration:0})}),console.log("âœ… Pre-log successful")}catch(t){console.error("âŒ Pre-log failed:",t)}};return e.jsxs("div",{ref:o,className:"pb-20",children:[e.jsxs("div",{className:"anime-banner-container relative w-full h-[50vh] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${c||s.poster})`,backgroundPosition:c?"center center":"center 20%",filter:c?"brightness(1)":"brightness(0.5) blur(3px)",transform:c?"scale(1.0)":"scale(1.1)"}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dhex-bg via-dhex-bg/60 to-transparent"})]}),e.jsx("div",{className:"container mx-auto px-6 -mt-32 relative z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"w-full md:w-64 flex-shrink-0",children:e.jsx("div",{className:"rounded-xl overflow-hidden shadow-2xl border-4 border-dhex-bg-secondary transform rotate-1 hover:rotate-0 transition-transform duration-500",children:e.jsx("img",{src:s.poster,alt:s.title,className:"w-full aspect-[3/4] object-cover"})})}),e.jsxs("div",{className:"flex-grow pt-4",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4 leading-tight",children:s.title}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400 mb-6",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{size:16,className:"text-dhex-accent"})," ",s.releaseDate||"Unknown"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{size:16,className:"text-yellow-500"})," ",s.rating||"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{size:16})," ",s.type||"TV"]}),e.jsxs("span",{className:`px-2 py-0.5 rounded bg-dhex-bg-secondary border border-white/10 text-xs flex items-center gap-1 ${(g=s.status)!=null&&g.toLowerCase().includes("complete")?"text-green-500 border-green-500/30":"text-white"}`,children:[((f=s.status)==null?void 0:f.toLowerCase().includes("complete"))&&e.jsx(k,{size:12}),s.status||"Ongoing"]})]}),e.jsx("div",{className:"text-gray-300 leading-relaxed max-w-3xl mb-8",children:s.synopsis?typeof s.synopsis=="string"?s.synopsis:typeof s.synopsis=="object"&&s.synopsis.paragraphs&&Array.isArray(s.synopsis.paragraphs)?s.synopsis.paragraphs.map((a,t)=>e.jsx("p",{className:"mb-4",children:a},t)):"Synopsis format unknown.":"No synopsis available."}),e.jsx("div",{className:"flex gap-4 mb-10",children:n.length>0&&e.jsxs(y,{to:`/watch/${d}/${n[n.length-1].episodeId}`,onClick:()=>p(n[n.length-1].episodeId),className:"px-8 py-3 bg-dhex-accent hover:bg-dhex-accent-hover text-white rounded-lg font-semibold flex items-center gap-2 transition-all hover:scale-105 shadow-lg shadow-dhex-accent/20",children:[e.jsx(u,{size:20,fill:"currentColor"})," Start Watching"]})}),e.jsxs("div",{className:"bg-dhex-bg-secondary rounded-xl p-6 border border-white/5",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx($,{size:20,className:"text-dhex-accent"}),"Episodes"]}),n.length===0?e.jsx("p",{className:"text-gray-500",children:"No episodes available yet."}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...n].reverse().map((a,t)=>{const r=t+1;return e.jsxs(y,{to:`/watch/${d}/${a.episodeId}`,onClick:()=>p(a.episodeId),className:"episode-item block bg-dhex-bg hover:bg-white/5 p-4 rounded-lg border border-white/5 hover:border-dhex-accent/50 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-mono text-dhex-accent font-bold",children:["EP ",r]}),e.jsx(u,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity text-dhex-accent"})]}),e.jsx("p",{className:"text-sm text-gray-400 truncate group-hover:text-white transition-colors",children:a.title||`${s.title} Episode ${r} Subtitle Indonesia`})]},a.episodeId)})})]})]})]})})]})};export{O as default};
